---

title: lemonade

keywords: fastai
sidebar: home_sidebar

summary: "An open source deep learning library for Electronic Health Record (EHR) data."
description: "An open source deep learning library for Electronic Health Record (EHR) data."
nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this initial release of the library ..</p>
<ul>
<li>it implements 2 deep learning models (an LSTM and a CNN) based on popular papers </li>
<li>that uses synthetic EHR data, created using the open source <a href="https://github.com/synthetichealth/synthea/wiki">Synthea Patient Generator</a></li>
<li>to predict 4 conditions that are on the <a href="https://www.cdc.gov/chronicdisease/about/costs/index.htm">CDC's list of top chronic diseases</a> that contribute most to healthcare costs</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The end goal is to</p>
<ul>
<li>keep adding more model implementations </li>
<li>keep adding different publicly available datasets </li>
<li>and have a leaderboard to track which models and configurations work best on these datasets</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2><p><code>pip install lemonade</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Setup-Synthea">Setup Synthea<a class="anchor-link" href="#Setup-Synthea"> </a></h3><ul>
<li><a href="https://github.com/synthetichealth/synthea/wiki">Synthea - Wiki</a><ul>
<li>contains details about what the project is and how to get started and generate the data.</li>
<li>download the binary - <a href="https://github.com/synthetichealth/synthea/wiki/Basic-Setup-and-Running">detailed here</a><ul>
<li>Don't run it yet</li>
</ul>
</li>
<li>Go to <code>./src/main/resources/synthea.properties</code> to update the default setings file and make the following updates<ul>
<li><code>exporter.years_of_history = 0</code> - to keep entire patient history</li>
<li><code>exporter.csv.export = true</code> - to export in csv format</li>
<li>set all other output formats to <code>false</code></li>
<li>leave other default settings intact</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="Generate-Data">Generate Data<a class="anchor-link" href="#Generate-Data"> </a></h4><ul>
<li>For our purposes, once Synthea is set up, the following scripts generate the data. </li>
<li>Its important to record the run dates, we will use this during preprocessing.<ul>
<li>Basic setup run command is: <code>java -jar synthea-with-dependencies.jar</code> </li>
<li>Developer setup run command is: <code>./run_synthea</code> </li>
</ul>
</li>
<li>Run with the <code>-p</code> switch to control population of patients generated as shown in examples below. </li>
</ul>
<p><code>./run_synthea -s 12345 -p 10000</code></p>
<ul>
<li>run date: 12-19-2019</li>
<li>{alive=10000, dead=1076}</li>
<li>raw - 1.5GB</li>
</ul>
<p><code>./run_synthea -s 54321 -p 20000</code></p>
<ul>
<li>run date: 11-5-2020</li>
<li>{alive=20000, dead=2195}</li>
<li>csv - 2.9GB</li>
</ul>
<p><code>./run_synthea -s 12345 -p 100000</code></p>
<ul>
<li>run date: 4-4-2020</li>
<li>{alive=100000, dead=10872}</li>
<li>csv - 14.6GB</li>
</ul>
<h3 id="Copy-Into-DataStore-/-Datastore-Folder-Structure">Copy Into DataStore / Datastore Folder Structure<a class="anchor-link" href="#Copy-Into-DataStore-/-Datastore-Folder-Structure"> </a></h3><ul>
<li>Choose a location to store all Synthea-generated data <ul>
<li>for example <code>~/code/datasets</code></li>
</ul>
</li>
<li>Copy data generated by Synthea into this specific folder structure <ul>
<li>for 10K data - <code>~/code/datasets/synthea/10K/raw_original</code></li>
<li><strong>Note</strong> - Synthea outputs all csv files in a folder called <code>csv</code>; after copying into the datastore, the csv files must be in the <code>raw_original</code> folder, where this library expects it for preprocessing</li>
</ul>
</li>
</ul>
<h3 id="Look-at-Quick-Starts">Look at Quick Starts<a class="anchor-link" href="#Look-at-Quick-Starts"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Roadmap">Roadmap<a class="anchor-link" href="#Roadmap"> </a></h2><ul>
<li><strong>A leader-board to track which models and configurations work best on different publicly available datasets</strong>.</li>
</ul>
<ul>
<li><p>Callbacks, Mixed Precision, etc</p>
<ul>
<li>Either upgrade the library to use fastai v2.</li>
<li>Or at least as a minimum, build functionality for fastai-style callbacks &amp; <a href="https://pytorch.org/docs/stable/amp.html">PyTorch AMP</a>.</li>
</ul>
</li>
<li><p>More models</p>
<ul>
<li>Pick some of the best EHR models out there and implement them.</li>
<li><strong>Ideas are welcome</strong>.</li>
</ul>
</li>
<li>More datasets<ul>
<li>eICU and MIMIC3 possibly.</li>
<li><strong>Ideas are welcome</strong>.</li>
</ul>
</li>
<li>NLP on clinical notes<ul>
<li>Synthea does not have clinical notes, so this can only be done with other datasets.</li>
</ul>
</li>
<li>Predicting different conditions<ul>
<li>Again different datasets will allow this - e.g. hospitalization data (length of stay, in-patient mortality), ER data, etc.</li>
</ul>
</li>
<li>Integraion with Experiment management tools like W&amp;B, Comet, etc,.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Known-Issues-&amp;-Limitations">Known Issues &amp; Limitations<a class="anchor-link" href="#Known-Issues-&amp;-Limitations"> </a></h2>
</div>
</div>
</div>
</div>
 

